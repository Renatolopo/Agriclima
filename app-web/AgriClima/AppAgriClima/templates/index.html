{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriClima</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/index.css' %}">
    <link rel="stylesheet" href="https://js.arcgis.com/4.25/esri/themes/light/main.css">
</head>
<body>

    <div class="container">
        <div class="navbar">
            <h1 class="navbar-brand">AgriClima</h1>
            <ul class="navbar-menu">
                <li><a href="#">Home</a></li>
                <li><a href="#">Sobre</a></li>
                <li><a href="#">Documentação</a></li>
                <li><a href="#">Sair</a></li>
            </ul>
        </div>
    
        <div class="content">
            <!-- Conteúdo da página aqui -->
            <h1>Título da Página</h1>
            <p>Conteúdo da página vai aqui...</p>

            
        </div>

        <div class="form-container">
            <h2>Selecione o Município</h2>
            <div id="map"></div>
            <form action="#" method="post">
                <div class="form-group">
                    <label for="municipio">Município:</label>
                    <input type="text" id="municipio" name="municipio" placeholder="Digite o nome do município" required>
                </div>
                <div class="form-group">
                    <label for="data_inicio">Data de Início:</label>
                    <input type="date" id="data_inicio" name="data_inicio" required>
                </div>
                <div class="form-group">
                    <label for="data_fim">Data de Fim:</label>
                    <input type="date" id="data_fim" name="data_fim" required>
                </div>
                <div class="form-group">
                    <input type="submit" value="Enviar">
                </div>
            </form>
        </div>

    </div>

    
        <!-- Leaflet.js CDN -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
        var map = L.map('map').setView([-15.0830, -44.1600], 9);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Adiciona um evento de clique ao mapa para obter o nome do município
        map.on('click', function(e) {
            var latlng = e.latlng;
            var latitude = latlng.lat.toFixed(6);
            var longitude = latlng.lng.toFixed(6);

            // Requisição para o serviço de geocodificação Nominatim para obter o nome do município
            var url = 'https://nominatim.openstreetmap.org/reverse?format=json&lat=' + latitude + '&lon=' + longitude + '&zoom=18&addressdetails=1';
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    var municipio = data.address.city || data.address.town || data.address.village || data.address.municipality;
                    document.getElementById('municipio').value = municipio;
                })
                .catch(error => console.error('Erro:', error));
        });

        // Adiciona um evento de mouseover para o texto do município
        map.on('mouseover', function(e) {
            var layer = e.layer;

            if (layer instanceof L.Marker) {
                layer.bindTooltip(layer.options.name, {permanent: true}).openTooltip();
                layer.getElement().style.cursor = 'pointer'; // Altera o cursor para pointer
                layer.getElement().style.color = '#007bff'; // Altera a cor do texto para azul
            }
        });

        // Adiciona um evento de mouseout para o texto do município
        map.on('mouseout', function(e) {
            var layer = e.layer;

            if (layer instanceof L.Marker) {
                layer.unbindTooltip();
                layer.getElement().style.cursor = 'default'; // Restaura o cursor para o padrão
                layer.getElement().style.color = '#000'; // Restaura a cor do texto para preto
            }
        });
    </script>

    
    
  

</body>
</html>
